# LovePetty 桌面宠物

一个专为情侣和好友设计的桌面宠物软件，支持跨平台（Windows、macOS）使用，通过云端服务器实现好友间的实时同步互动。

## ✨ 功能特性

### 🐕 桌面宠物
- **两只可爱小狗**：粉色和蓝色的小狗，支持表情变化和互动
- **拖拽移动**：可以自由拖拽桌宠到屏幕任意位置
- **稳定显示**：不会因点击外部区域而消失
- **系统托盘**：支持后台运行，最小化到系统托盘

### 👥 好友系统
- **用户注册**：每个用户注册唯一ID，用于好友搜索
- **好友搜索**：通过用户ID搜索其他用户
- **好友申请**：发送和接受好友申请
- **实时同步**：好友间的宠物动作实时同步

### 🎮 互动功能
- **宠物控制**：每人可以选择控制其中一只小狗
- **表情变化**：开心、难过、愤怒、骄傲、害羞、惊讶
- **互动动作**：抚摸、拥抱、亲吻、捏脸、敲打

## 🚀 快速开始

### 安装依赖
```bash
pip install -r requirements.txt
```

### 运行程序
```bash
python main.py
```

### 测试功能
```bash
python test.py
```

## 📖 使用说明

### 1. 用户注册
- 启动程序后会自动弹出用户注册对话框
- 点击"生成ID"创建唯一用户ID
- 输入昵称并确认注册

### 2. 控制宠物
- 点击桌宠显示交互菜单
- 选择"控制小狗1"或"控制小狗2"
- 设置表情和互动动作

### 3. 好友功能
- 右键桌宠选择"好友搜索"
- 输入其他用户的ID进行搜索
- 发送好友申请并等待接受

### 4. 实时同步
- 好友间可以实时看到对方的宠物动作
- 表情变化和互动会同步显示

## 🏗️ 项目结构

```
Lovepetty/
├── main.py                    # 主程序入口
├── pet_window.py             # 桌面宠物窗口
├── friend_network_manager.py # 好友网络管理器
├── user_registration_dialog.py # 用户注册对话框
├── friend_search_dialog.py   # 好友搜索对话框
├── friend_server.py          # 服务器示例
├── requirements.txt          # 依赖列表
├── test.py                  # 测试脚本
├── DEPLOYMENT.md            # 部署说明
├── USAGE.md                 # 使用说明
└── README.md                # 项目说明
```

## 🔧 技术栈

- **GUI框架**: PyQt5
- **网络通信**: requests + Flask
- **部署平台**: Render.com
- **编程语言**: Python 3.9+
- **操作系统**: Windows, macOS

## 🌐 服务器部署

### 本地测试
```bash
python friend_server.py
```

### 云端部署
1. 将 `friend_server.py` 部署到 Render.com
2. 更新客户端中的 `server_url`
3. 配置环境变量和依赖

## 📝 API接口

### 用户管理
- `POST /register_user` - 注册用户
- `GET /search_user` - 搜索用户

### 好友系统
- `POST /send_friend_request` - 发送好友申请
- `POST /accept_friend_request` - 接受好友申请
- `GET /friends` - 获取好友列表
- `GET /friends_status` - 获取好友在线状态

### 消息通信
- `POST /send` - 发送消息
- `GET /messages` - 获取消息
- `POST /heartbeat` - 心跳包

## 🎯 核心改进

### 解决的关键问题
1. ✅ **拖拽功能**：正确处理鼠标事件，区分点击和拖拽
2. ✅ **窗口稳定性**：使用特殊窗口属性防止意外消失
3. ✅ **好友系统**：从情侣配对改为好友申请制
4. ✅ **用户体验**：不需要强制配对，可以独立使用

### 版本对比
- **v1.0**: 情侣配对制，需要强制绑定
- **v2.0**: 好友申请制，更灵活的用户关系

## 🔮 未来计划

- [ ] 动画系统：实现帧动画
- [ ] 音效支持：添加互动音效
- [ ] 自定义皮肤：支持自定义宠物外观
- [ ] 消息系统：添加文字消息功能
- [ ] 文件共享：支持图片和文件分享
- [ ] 多语言：国际化支持

## 📄 许可证

本项目采用 MIT 许可证。

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

---

**LovePetty** - 让桌面宠物成为连接好友的桥梁 🐕💕